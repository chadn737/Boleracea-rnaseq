nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="cabbage" & sig$sampleB=="TO1000",]),
(nrow(all_genes)-length(syn$Bo_gene %in% all_genes$gene)),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="kale" & sig$sampleB=="TO1000",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="kale" & sig$sampleB=="cabbage",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="cabbage" & sig$sampleB=="TO1000",]))
pSyn
test <- data.frame(row.names=c("Genome","KvT","KvC","CvT"),syntenic=c(24521,3519,3469,3514),nonsyntenic=c(34704,4596,3875,3915))
chisq.test(test)
test
test <- data.frame(row.names=c("Genome","KvT","KvC","CvT"),syntenic=pSyn[c(1:4),]$number,nonsyntenic=pSyn[c(5:8),]$number)
test
24521-3519
24521-3469
24521-3514
34704-4596
34704-3875
34704-3915
test <- data.frame(row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG","KvC Non-DEG","CvT DEG","CvT Non-DEG"),
syntenic=c(24521,3519,21002,3469,21052,3514,21007),nonsyntenic=c(34704,4596,30108,3875,30829,3915,30789))
chisq.test(test[c(2:3),])
test
test[c(2:3), ]
chisq.test(test[c(2:3),]$syntenic,test[c(2:3),]$nonsyntenic)
chisq.test(test[c(2:3),]$syntenic,test[c(2:3),]$nonsyntenic,correct=F)
chisq.test(test[c(4:5),]$syntenic,test[c(4:5),]$nonsyntenic,correct=F)
test[c(4:5),]
chisq.test(test[c(6:7),]$syntenic,test[c(6:7),]$nonsyntenic,correct=F)
test[c(4:5),]
chisq.test(test[c(6:7),]$syntenic,correct=F)
chisq.test(test[c(6:7),]$syntenic,test[c(6:7),]$nonsyntenic,correct=F)
chisq.test(test[c(6:7),]$syntenic,test[c(6:7),]$nonsyntenic,correct=T)
test2 <- t(test)
ttest
test2
chisq.test(test2[,c(2:3)])
test2[,c(2:3)]
chisq.test(test2[,c(2:3)])
chisq.test(t(test2[,c(2:3)]))
t(test2[,c(2:3)])
chisq.test(t(test2[,c(2:3)]))
?phyper
phyper(3519,21002,30108,3519+4596,)
phyper(4596,30108,21002,3519+4596,)
phyper(4596,30108,21002,3519+4596)
pSyn
phyper(4596,30108,21002,3519+4596)
phyper(3519,21002,30108,3519+4596,)
test
phyper(3519,24521,34704,4596)
phyper(3519,24521,34704,4596,lower.tail = T)
phyper(3519,24521,34704,4596,lower.tail = F)
phyper(3519,24521,34704,4596,lower.tail = T)
phyper(4596,34704,24521,3519,lower.tail = T)
fisher.test(3519,21002,4596,30108)
fisher.test(matrix(c(3519,21002,4596,30108),2,2))
fisher.test(matrix(c(3519,21002,4596,30108),2,2),alternative='less')
fisher.test(matrix(c(3519,21002,4596,30108),2,2),alternative='more')
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative=)
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2))
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative='greater')
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative='less')
test
phyper(3519,24521,34704,3519+4596,lower.tail = F)
phyper(3519,24521,34704,3519+4596,lower.tail = T)
phyper(3519-1,24521,34704,3519+4596,lower.tail = F)
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative='greater')$p.value
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative='lesser')$p.value
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative='less')$p.value
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2))$p.value
phyper(3519-1,24521,34704,3519+4596,lower.tail = F)
phyper(3519-1,24521,34704,3519+4596,lower.tail = F)
phyper(3519,24521,34704,3519+4596,lower.tail = T)
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative="greater")$p.value
fisher.test(matrix(c(3519,21002,4596,30108),2,2),alternative="greater")$p.value
fisher.test(matrix(c(3519,21002,4596,30108),2,2),alternative="less")$p.value
3519+4596
fisher.test(matrix(c(3519,21002,4596,30108-8115+8115),2,2),alternative="less")$p.value
fisher.test(matrix(c(3519,21002,4596,30108-8115+3519),2,2),alternative="less")$p.value
fisher.test(matrix(c(1,12,4,35),2,2),alternative="less")$p.value
fisher.test(matrix(c(3519,21002,4596,30108+3519),2,2),alternative="greater")$p.value
fisher.test(matrix(c(3519-1,21002,4596,30108),2,2),alternative="greater")$p.value
phyper(3519,24521,34704,3519+4596,lower.tail = T)
phyper(3519-1,24521,34704,3519+4596,lower.tail = F)
fisher.test(matrix(c(3519-1,21002,4596,30108),2,2))$p.value
fisher.test(matrix(c(3519-1,21002,4596,30108),2,2))
fisher.test(matrix(c(3519,21002,4596,30108),2,2))
?fisher.test
test
fisher.test(matrix(c(test[c(2:3),]),2,2))
fisher.test(matrix(c(test[c(2:3),]),2,2))
fisher.test(matrix(c(test[c(2:3),]),2,2))
matrix(c(test[c(2:3),]),2,2
)
matrix(test[c(2:3),])
as.matrix(test[c(2:3),])
matrix(c(3519,21002,4596,30108),2,2)
fisher.test(as.matrix(test[c(2:3),]),2,2))
fisher.test(as.matrix(test[c(2:3),]))
fisher.test(as.matrix(test[c(4:5),]))
fisher.test(as.matrix(test[c(6:7),]))
as.matrix(test[c(7,6),]
)
test[c(6:7),]
test[c(7,6),]
test[c(7:6),]
test[c(6:7),c(7,6)]
test[c(6:7),c(2,1)]
fisher.test(as.matrix(test[c(2:3),c(2,1)]))
fisher.test(as.matrix(test[c(4:5),c(2,1)]))
fisher.test(as.matrix(test[c(6:7),c(2,1)]))
number=c(nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]))
number
test
24521+34704
number=c(nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF2",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]))
number
59225-10763
59225-7420
59225-6338
test
3519+4596
3469+3875
3514+3514
8115-1463
8115-1120
8115-936
59225,nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="MF2",]))
c(59225,nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="MF2",]))
7344-1472
7344-1121
7344-876
c(59225,nrow(syn[syn$subgenome=="LF",]),
nrow(synSig[synSig$sampleA=="cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",]),
nrow(syn[syn$subgenome=="MF1",]),
nrow(synSig[synSig$sampleA=="cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",]))
7028-1502
7028-1099
7028-913
test2 <- data.frame(
row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG","KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(10763,1463,1472,1502),
nonLF(48462,6652,5872,5526),
MF1=c(7420,1120,1121,1099),
nonMF1=c(51805,6995,6223,5929),
MF2=c(6338,936,876,913),
nonMF2=c(52887,7179,6468,6115))
test2 <- data.frame(
row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG","KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(10763,1463,1472,1502),
nonLF=c(48462,6652,5872,5526),
MF1=c(7420,1120,1121,1099),
nonMF1=c(51805,6995,6223,5929),
MF2=c(6338,936,876,913),
nonMF2=c(52887,7179,6468,6115))
test2 <- data.frame(
row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG","KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(10763,1463,,1472,,1502,),
nonLF=c(48462,6652,,5872,,5526,),
MF1=c(7420,1120,,1121,,1099,),
nonMF1=c(51805,6995,,6223,,5929,),
MF2=c(6338,936,,876,,913,),
nonMF2=c(52887,7179,,6468,,6115,))
1463+6652
10763+48462
59225-8115
10763-1463
10763-1472
10763-1502
48462-6652
48462-5872
48462-5526
7420-1120
7420-1121
7420-1099
51805-6995
51805-6223
51805-5929
6338-936
6338-876
6338-913
52887-7179
52887-6468
52887-6115
test2 <- data.frame(
row.names=c("Genome","KvT DEG","KvT Non-DEG","KvC DEG","KvC Non-DEG","CvT DEG","CvT Non-DEG"),
LF=c(10763,1463,9300,1472,9291,1502,9261),
nonLF=c(48462,6652,41810,5872,2590,5526,42936),
MF1=c(7420,1120,6300,1121,6299,1099,6321),
nonMF1=c(51805,6995,44810,6223,45582,5929,45876),
MF2=c(6338,936,5402,876,5462,913,5425),
nonMF2=c(52887,7179,45708,6468,46419,6115,46772))
ttest
test2
fisher.test(as.matrix(test[c(2:3),c(1,2)]))
fisher.test(as.matrix(test[c(4:5),c(1,2)]))
fisher.test(as.matrix(test[c(6:7),c(1,2)]))
fisher.test(as.matrix(test[c(2:3),c(2,1)]))
fisher.test(as.matrix(test[c(4:5),c(2,1)]))
fisher.test(as.matrix(test[c(6:7),c(2,1)]))
fisher.test(as.matrix(test[c(2:3),c(3,4)]))
fisher.test(as.matrix(test[c(4:5),c(3,4)]))
fisher.test(as.matrix(test[c(2:3),c(3,4)]))
fisher.test(as.matrix(test[c(4:5),c(3,4)]))
fisher.test(as.matrix(test[c(6:7),c(3,4)]))
test
fisher.test(as.matrix(test2[c(2:3),c(1,2)]))
fisher.test(as.matrix(test2[c(4:5),c(1,2)]))
fisher.test(as.matrix(test2[c(6:7),c(1,2)]))
fisher.test(as.matrix(test2[c(2:3),c(2,1)]))
fisher.test(as.matrix(test2[c(4:5),c(2,1)]))
fisher.test(as.matrix(test2[c(6:7),c(2,1)]))
fisher.test(as.matrix(test2[c(2:3),c(3,4)]))
fisher.test(as.matrix(test2[c(4:5),c(3,4)]))
fisher.test(as.matrix(test2[c(6:7),c(3,4)]))
fisher.test(as.matrix(test2[c(2:3),c(4,3)]))
fisher.test(as.matrix(test2[c(4:5),c(4,3)]))
fisher.test(as.matrix(test2[c(6:7),c(4,3)]))
fisher.test(as.matrix(test2[c(2:3),c(5,6)]))
fisher.test(as.matrix(test2[c(4:5),c(5,6)]))
fisher.test(as.matrix(test2[c(6:7),c(5,6)]))
fisher.test(as.matrix(test2[c(2:3),c(6,5)]))
fisher.test(as.matrix(test2[c(4:5),c(6,5)]))
fisher.test(as.matrix(test2[c(6:7),c(6,5)]))
#Syntenic genes
#
syn <- read.table("../misc/Bo-At-syntelogs.tsv",header=T,sep="\t")
synRes <- merge(resfull,syn,by.x="id",by.y="Bo_gene")
synSig <- merge(sig,syn,by.x="id",by.y="Bo_gene")
#Syntenic vs Non-Syntenic
pSyn=data.frame(
row.names=c("Genome: Percent Syntenic",
"KvT DEGs: Percent Syntenic",
"KvC DEGs: Percent Syntenic",
"CvT DEGs: Percent Syntenic",
"Genome: Percent Non-Syntenic",
"KvT DEGs: Percent Non-Syntenic",
"KvC DEGs: Percent Non-Syntenic",
"CvT DEGs: Percent Non-Syntenic"),
percent=c(length(syn$Bo_gene %in% all_genes$gene)/nrow(all_genes),
nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="kale" & sig$sampleB=="TO1000",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="TO1000",]),
nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="kale" & sig$sampleB=="cabbage",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="cabbage",]),
nrow(sig[sig$id %in% syn$Bo_gene & sig$sampleA=="cabbage" & sig$sampleB=="TO1000",])/nrow(sig[sig$sampleA=="cabbage" & sig$sampleB=="TO1000",]),
(nrow(all_genes)-length(syn$Bo_gene %in% all_genes$gene))/nrow(all_genes),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="kale" & sig$sampleB=="TO1000",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="TO1000",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="kale" & sig$sampleB=="cabbage",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="cabbage",]),
nrow(sig[!(sig$id %in% syn$Bo_gene) & sig$sampleA=="cabbage" & sig$sampleB=="TO1000",])/nrow(sig[sig$sampleA=="cabbage" & sig$sampleB=="TO1000",])),
order=c(1,2,3,4,5,6,7,8))
#Make Plot
ggsave("Syntenic_genes.pdf",
ggplot(pSyn,aes(x=reorder(row.names(pSyn),order),y=percent,fill=reorder(row.names(pSyn),order))) +
geom_bar(stat="identity") +
theme(panel.background=element_blank(),
axis.line=element_line(color="black"),
axis.text=element_text(color="black"),
axis.title=element_text(color="black",face="bold"),
axis.text.x=element_text(angle=315,hjust=0),
legend.position="none") +
scale_y_continuous(expand=c(0,0),labels=percent) +
scale_fill_manual(values=c("tomato2",
"dodgerblue3",
"palegreen4",
"khaki3",
"tomato2",
"dodgerblue3",
"palegreen4",
"khaki3")) +
ylab("Percentage of Genes") +
xlab(""))
#KvT subgenome
KvTsub=data.frame(
row.names=c("Genome: Percent LF",
"DEGs: Percent LF",
"Genome: Percent MF1",
"DEGs: Percent MF1",
"Genome: Percent MF2",
"DEGs: Percent MF2"),
percent=c(nrow(syn[syn$subgenome=="LF",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="TO1000",]),
nrow(syn[syn$subgenome=="MF1",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="TO1000",]),
nrow(syn[syn$subgenome=="MF2",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="TO1000",])),
order=c(1,2,3,4,5,6))
#Make Plot
ggsave("KvT_subgenome.pdf",
ggplot(KvTsub,aes(x=reorder(row.names(KvTsub),order),y=percent,fill=reorder(row.names(KvTsub),order))) +
geom_bar(stat="identity") +
theme(panel.background=element_blank(),
axis.line=element_line(color="black"),
axis.text=element_text(color="black"),
axis.title=element_text(color="black",face="bold"),
axis.text.x=element_text(angle=315,hjust=0),
legend.position="none") +
scale_y_continuous(expand=c(0,0),labels=percent) +
scale_fill_manual(values=c("tomato2",
"tomato2",
"dodgerblue3",
"dodgerblue3",
"black",
"black")) +
ylab("Percentage of Genes") +
xlab(""))
#Log2FC distribution
tmp <- synRes[synRes$sampleA=="kale" & synRes$sampleB=="TO1000",]
tmp$direction <- ifelse(tmp$log2FC > 0 & tmp$padj < 0.05,1,ifelse(tmp$log2FC < 0 & tmp$padj < 0.05,-1,0))
tmp2 <- tmp[tmp$direction != 0,]$At_gene
tmp2 <- as.vector(unique(tmp[tmp$direction != 0,]$At_gene))
tmp3 <- tmp[tmp$At_gene %in% tmp2,]
ggsave("KvT_subgenome_log2FC.pdf",
ggplot(tmp3[tmp3$padj<=0.05,],aes(x=log2FC,color=subgenome)) +
geom_density(size=1) +
theme(panel.background=element_blank(),
axis.line=element_line(color="black"),
axis.text=element_text(color="black"),
axis.title=element_text(color="black",face="bold"),
axis.text.x=element_text(),
legend.position="right") +
scale_y_continuous(expand=c(0,0)) +
scale_color_manual(values=c("dodgerblue","tomato2","black")) +
ylab("Density") +
xlab("Log2 Fold Change"))
#Homoeolog direction
tmp4 <- tmp[,c(10,9,11)]
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$subgenome))
tmp5$sum <- rowSums(tmp5)
tmp6 <- as.vector(row.names(tmp5[tmp5$sum != tmp5$LF & tmp5$sum != tmp5$MF1 & tmp5$sum != tmp5$MF2,]))
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$direction))
tmp5 <- tmp5[row.names(tmp5) %in% as.vector(unique(tmp$At_gene)),]
tmp5$sum <- rowSums(tmp5)
tmp7 <- tmp5[tmp5$sum > 1 & row.names(tmp5) %in% tmp6,]
pdf("KvT_homoeologs_VennDiagram.pdf",width=6,height=6,paper='special')
draw.triple.venn(area1=nrow(tmp7[tmp7$`-1`> 0,]),
area2=nrow(tmp7[tmp7$`1`> 0,]),
area3=nrow(tmp7[tmp7$`0`> 0,]),
n12=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0,]),
n23=nrow(tmp7[tmp7$`1`> 0 & tmp7$`0`> 0,]),
n13=nrow(tmp7[tmp7$`0`> 0 & tmp7$`-1`> 0,]),
n123=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0 & tmp7$`0`> 0,]),
category = c("Lower Expression", "Higher Expression", "No Difference"),
lty = "blank",
fill = c("skyblue", "pink1", "mediumorchid"))
dev.off()
#KvC subgenome
KvCsub=data.frame(
row.names=c("Genome: Percent LF",
"DEGs: Percent LF",
"Genome: Percent MF1",
"DEGs: Percent MF1",
"Genome: Percent MF2",
"DEGs: Percent MF2"),
percent=c(nrow(syn[syn$subgenome=="LF",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="LF",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="cabbage",]),
nrow(syn[syn$subgenome=="MF1",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="MF1",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="cabbage",]),
nrow(syn[syn$subgenome=="MF2",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="kale" & synSig$sampleB=="cabbage" & synSig$subgenome=="MF2",])/nrow(sig[sig$sampleA=="kale" & sig$sampleB=="cabbage",])),
order=c(1,2,3,4,5,6))
#Make Plot
ggsave("KvC_subgenome.pdf",
ggplot(KvCsub,aes(x=reorder(row.names(KvCsub),order),y=percent,fill=reorder(row.names(KvCsub),order))) +
geom_bar(stat="identity") +
theme(panel.background=element_blank(),
axis.line=element_line(color="black"),
axis.text=element_text(color="black"),
axis.title=element_text(color="black",face="bold"),
axis.text.x=element_text(angle=315,hjust=0),
legend.position="none") +
scale_y_continuous(expand=c(0,0),labels=percent) +
scale_fill_manual(values=c("tomato2",
"tomato2",
"dodgerblue3",
"dodgerblue3",
"black",
"black")) +
ylab("Percentage of Genes") +
xlab(""))
#Log2FC distribution
tmp <- synRes[synRes$sampleA=="kale" & synRes$sampleB=="cabbage",]
tmp$direction <- ifelse(tmp$log2FC > 0 & tmp$padj < 0.05,1,ifelse(tmp$log2FC < 0 & tmp$padj < 0.05,-1,0))
tmp2 <- tmp[tmp$direction != 0,]$At_gene
tmp2 <- as.vector(unique(tmp[tmp$direction != 0,]$At_gene))
tmp3 <- tmp[tmp$At_gene %in% tmp2,]
ggsave("KvC_subgenome_log2FC.pdf",
ggplot(tmp3[tmp3$padj<=0.05,],aes(x=log2FC,color=subgenome)) +
geom_density(size=1) +
theme(panel.background=element_blank(),
axis.line=element_line(color="black"),
axis.text=element_text(color="black"),
axis.title=element_text(color="black",face="bold"),
axis.text.x=element_text(),
legend.position="right") +
scale_y_continuous(expand=c(0,0)) +
scale_color_manual(values=c("dodgerblue","tomato2","black")) +
ylab("Density") +
xlab("Log2 Fold Change"))
#Homoeolog direction
tmp4 <- tmp[,c(10,9,11)]
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$subgenome))
tmp5$sum <- rowSums(tmp5)
tmp6 <- as.vector(row.names(tmp5[tmp5$sum != tmp5$LF & tmp5$sum != tmp5$MF1 & tmp5$sum != tmp5$MF2,]))
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$direction))
tmp5 <- tmp5[row.names(tmp5) %in% as.vector(unique(tmp$At_gene)),]
tmp5$sum <- rowSums(tmp5)
tmp7 <- tmp5[tmp5$sum > 1 & row.names(tmp5) %in% tmp6,]
pdf("KvC_homoeologs_VennDiagram.pdf",width=6,height=6,paper='special')
draw.triple.venn(area1=nrow(tmp7[tmp7$`-1`> 0,]),
area2=nrow(tmp7[tmp7$`1`> 0,]),
area3=nrow(tmp7[tmp7$`0`> 0,]),
n12=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0,]),
n23=nrow(tmp7[tmp7$`1`> 0 & tmp7$`0`> 0,]),
n13=nrow(tmp7[tmp7$`0`> 0 & tmp7$`-1`> 0,]),
n123=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0 & tmp7$`0`> 0,]),
category = c("Lower Expression", "Higher Expression", "No Difference"),
lty = "blank",
fill = c("skyblue", "pink1", "mediumorchid"))
dev.off()
#CvT subgenome
CvTsub=data.frame(
row.names=c("Genome: Percent LF",
"DEGs: Percent LF",
"Genome: Percent MF1",
"DEGs: Percent MF1",
"Genome: Percent MF2",
"DEGs: Percent MF2"),
percent=c(nrow(syn[syn$subgenome=="LF",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="LF",])/nrow(sig[sig$sampleA=="cabbage" & sig$sampleB=="TO1000",]),
nrow(syn[syn$subgenome=="MF1",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF1",])/nrow(sig[sig$sampleA=="cabbage" & sig$sampleB=="TO1000",]),
nrow(syn[syn$subgenome=="MF2",])/nrow(all_genes),
nrow(synSig[synSig$sampleA=="cabbage" & synSig$sampleB=="TO1000" & synSig$subgenome=="MF2",])/nrow(sig[sig$sampleA=="cabbage" & sig$sampleB=="TO1000",])),
order=c(1,2,3,4,5,6))
#Make Plot
ggsave("CvT_subgenome.pdf",
ggplot(CvTsub,aes(x=reorder(row.names(CvTsub),order),y=percent,fill=reorder(row.names(CvTsub),order))) +
geom_bar(stat="identity") +
theme(panel.background=element_blank(),
axis.line=element_line(color="black"),
axis.text=element_text(color="black"),
axis.title=element_text(color="black",face="bold"),
axis.text.x=element_text(angle=315,hjust=0),
legend.position="none") +
scale_y_continuous(expand=c(0,0),labels=percent) +
scale_fill_manual(values=c("tomato2",
"tomato2",
"dodgerblue3",
"dodgerblue3",
"black",
"black")) +
ylab("Percentage of Genes") +
xlab(""))
#Log2FC distribution
tmp <- synRes[synRes$sampleA=="cabbage" & synRes$sampleB=="TO1000",]
tmp$direction <- ifelse(tmp$log2FC > 0 & tmp$padj < 0.05,1,ifelse(tmp$log2FC < 0 & tmp$padj < 0.05,-1,0))
tmp2 <- tmp[tmp$direction != 0,]$At_gene
tmp2 <- as.vector(unique(tmp[tmp$direction != 0,]$At_gene))
tmp3 <- tmp[tmp$At_gene %in% tmp2,]
ggsave("CvT_subgenome_log2FC.pdf",
ggplot(tmp3[tmp3$padj<=0.05,],aes(x=log2FC,color=subgenome)) +
geom_density(size=1) +
theme(panel.background=element_blank(),
axis.line=element_line(color="black"),
axis.text=element_text(color="black"),
axis.title=element_text(color="black",face="bold"),
axis.text.x=element_text(),
legend.position="right") +
scale_y_continuous(expand=c(0,0)) +
scale_color_manual(values=c("dodgerblue","tomato2","black")) +
ylab("Density") +
xlab("Log2 Fold Change"))
#Homoeolog direction
tmp4 <- tmp[,c(10,9,11)]
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$subgenome))
tmp5$sum <- rowSums(tmp5)
tmp6 <- as.vector(row.names(tmp5[tmp5$sum != tmp5$LF & tmp5$sum != tmp5$MF1 & tmp5$sum != tmp5$MF2,]))
tmp5 <- as.data.frame.matrix(table(tmp4$At_gene,tmp4$direction))
tmp5 <- tmp5[row.names(tmp5) %in% as.vector(unique(tmp$At_gene)),]
tmp5$sum <- rowSums(tmp5)
tmp7 <- tmp5[tmp5$sum > 1 & row.names(tmp5) %in% tmp6,]
pdf("CvT_homoeologs_VennDiagram.pdf",width=6,height=6,paper='special')
draw.triple.venn(area1=nrow(tmp7[tmp7$`-1`> 0,]),
area2=nrow(tmp7[tmp7$`1`> 0,]),
area3=nrow(tmp7[tmp7$`0`> 0,]),
n12=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0,]),
n23=nrow(tmp7[tmp7$`1`> 0 & tmp7$`0`> 0,]),
n13=nrow(tmp7[tmp7$`0`> 0 & tmp7$`-1`> 0,]),
n123=nrow(tmp7[tmp7$`-1`> 0 & tmp7$`1`> 0 & tmp7$`0`> 0,]),
category = c("Lower Expression", "Higher Expression", "No Difference"),
lty = "blank",
fill = c("skyblue", "pink1", "mediumorchid"))
dev.off()
